<%# simple_form_for [@surfcamp, @booking, @occupancy_] do |f| %>
  <%# f.input :starts_at, as: :string, placeholder: "02/09/2017", class: "col-xs-6", input_html: {class: 'datepicker'},label: "Check in" %>
  <%# f.input :ends_at, as: :string, placeholder: "12/09/2017", class: "col-xs-6", input_html: {class: 'datepicker'}, label: "Check out"  %>
  <%# f.label "Dormitory" %>
  <%# f.input :occupancy.pax_nb, placeholder: "1" %>
  <%# f.label "Private Room" %>
  <%# f.input :occupancy.pax_nb, placeholder: "1" %>
  <%# f.label "Price per Day: **TBD**" %>
  <%# f.submit "Book it!", class: "btn btn-danger btn-block" %>
<%# end %>
<div class="booking-promo">
  <div class="booking-promo-percentage">
    <% @pourcentage = ((1 - @surfcamp.discounts.first.discounted_price.to_f / @surfcamp.price_per_night_per_person.to_f) * 100).to_i %>
    <p><%= @pourcentage %>% OFF</p>
  </div>
  <div class="booking-promo-date">
    <p><%= (@surfcamp.discounts.first.discount_ends_at.to_date - Date.today.to_date).to_i %> days left</p>
  </div>
</div>
<div class="booking-form">
  <div class="booking-input">
    <%= form_tag surfcamp_bookings_path(surfcamp) do %>
    <div class="row">
      <div class="col-xs-6 booking-form-start-date">
        <%= label_tag 'booking[starts_at]', 'Checkin' %>
        <div class="booking-form-start-date-input">
          <i class="fa fa-calendar" aria-hidden="true"></i>
          <%= text_field_tag 'booking[starts_at]', nil, id: "start_date", class: "datepicker", placeholder: "02/09/2017", style: "width: 100%" %>
          <% if errors[:starts_at] %>
           <div class= "form_error_message">
            <%= errors[:starts_at] %>
          </div>
          <% end %>
        </div>
      </div>
      <div class="col-xs-6 booking-form-end-date">
        <%= label_tag 'booking[ends_at]', 'Checkout' %>
        <div class="booking-form-end-date-input">
          <i class="fa fa-calendar" aria-hidden="true"></i>
          <%= text_field_tag 'booking[ends_at]', nil, id: "end_date", class: "datepicker", placeholder: "10/09/2017", style: "width: 100%" %>
          <% if errors[:ends_at] %>
          <div class= "form_error_message">
            <%= errors[:ends_at] %>
          </div>
          <% end %>
        </div>
      </div>
    </div>
    <%= label_tag 'booking[pax_nb]', 'Surfers' %>
    <div class="booking-form-pax-nb">
      <i class="fa fa-male" aria-hidden="true"></i>
      <%= number_field_tag 'booking[pax_nb]', '1', style: "width: 100%", id: "pax_nb", class: "form-control" %>
      <% if current_user.nil? %>
      <% else %>
      <%= hidden_field_tag 'booking[user_id]', current_user.id %>
      <% end %>
      <%= hidden_field_tag 'booking[status]', 'unpaid' %>
    </div>
    <hr>
    <div class="booking-form-total">
      <p>Total:</p>
      <p>125â‚¬</p>
    </div>
      <%= submit_tag "Book now", class: "btn btn-primary", style: "width: 100%" %>
    <% end %>
  </div>
</div>
<!-- <script>
  let start_date = document.getElementById("start_date").value
  let split_start_date = start_date.split('/');
  let right_start_date = new Date(split_start_date[2],split_start_date[1]-1,split_start_date[0]);
  let end_date = document.getElementById("end_date").value
  let split_end_date = end_date.split('/');
  let right_end_date = new Date(split_end_date[2],split_end_date[1]-1,split_end_date[0]);
  let days = Math.floor((right_end_date - right_start_date) / (1000*60*60*24))
  let dates = []
  let i = 0
  _.times(days, function() {
    dates.push(right_start_date.setDate(right_start_date.getDate() + i));
    i++;
  });
  pax_num = document.getElementById("pax_nb").value
</script> -->

<% content_for(:after_js) do %>
  <%= javascript_tag do %>
    $(".datepicker").datepicker({
    format: 'dd/mm/yyyy',
    startDate: '-1d'
    });
  <% end %>
<% end %>
